@model IEnumerable<Order>
@{ ViewData["Title"] = "Orders"; }

<h2>Orders</h2>
<hr />
@if (Model.Count() > 0)
{
@foreach (var order in Model)
{
<div class="card shadow-sm mt-3 mb-3">
	<div class="card-header">
		Order completed at <b>@order.OrderPlaced</b>
	</div>
	<div class="card-body">
		<table class="table">
			<thead class="thead-dark">
				<tr>
					<th>#</th>
					<th>Name</th>
					<th>Address</th>
					<th>City</th>
					<th>Country</th>
					<th>Total</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td>@order.OrderId</td>
					<td>@order.LastName @order.FirstName</td>
					<td>@order.AddressLine1</td>
					<td>@order.City</td>
					<td>@order.Country</td>
					<td><b>@order.OrderTotal.ToString("c")</b></td>
				</tr>
				<tr>
					<td colspan="6">
						<div class="card">
							<div class="card-header">
								@order.OrderDetails.Count order items.
							</div>
							<div class="card-body">
								<h5 class="card-title"></h5>
								<table class="table table-striped table-sm">
									<thead class="thead-dark">
										<tr>
											<th>#</th>
											<th>Image</th>
											<th>Item</th>
											<th>Price</th>
											<th>Amount</th>
											<th>SubTotal</th>
										</tr>
									</thead>
									<tbody>
										@foreach (var orderDetail in order.OrderDetails)
										{
										<tr>
											<td>@orderDetail.OrderDetailId</td>
											<td>
												<img src=@orderDetail.Pie.ImageThumbnailUrl
														 alt=@orderDetail.Pie.Name
														 class="img-thumbnail"
														 style="width: 64px" />
											</td>
											<td>@orderDetail.Pie.Name</td>
											<td>@orderDetail.Pie.Price.ToString("c")</td>
											<td>@orderDetail.Amount</td>
											<td>
												@((orderDetail.Pie.Price * orderDetail.Amount).ToString("c"))
											</td>
										</tr>
										}
									</tbody>
								</table>
							</div>
						</div>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
</div>} }
			else
			{
<h3>No Orders found.</h3>}